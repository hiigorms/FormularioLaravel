 e=i.isCortanaEnabled?n.safeExecute(function(){return i.getCortanaCapabilities()},"getCortanaCapabilities","").split(","):[],o=n.contains(e,"Personalization");i.currentState==0&&f._triggerSSO&&o&&(f._triggerSSO=!1,t.config.wamSupported?t.Promise.safeChain("enumerateAccountAuthorityAsync",function(){return i.authenticationManager.enumerateAccountAuthorityAsync()},function(n){var o,i,e;t.config.enableSSOV2?(o=n.Cortana=="consumers"?u:r,f.silentSignIn(o)):(i=n.Windows,e=n.Cortana,t.WebTelemetry&&t.WebTelemetry.logSignInAccountEvent(i,e),i=="organizations"?f.silentSignIn(r):i=="consumers"&&e=="consumers"&&f.silentSignIn(u))}):t.Promise.safeChain("getQueryHeadersAsync",function(){return i.getQueryHeadersAsync()},function(n){n&&(f.silentSignIn(r),n["X-Search-RPSToken"]&&f.silentSignIn(u))}))};n.isBrowserOnline()?e():sj_be(_w,"online",function(){e()})},a.prototype.silentSignIn=function(o){var v=this,l=s+"campaign_source=WSB&provider="+o,a;t.config.th&&(l=ClientTestHooks.CopyTestParameters(_w.location.search,l));a=function(s){var a,y,l;t.WebTelemetry&&t.WebTelemetry.logShouldSSOEvent(o,s?!0:!1);s&&(a=o==u,y=function(n){var i=n&&!n.IsError;t.WebTelemetry&&t.WebTelemetry.logAuthCompleteEvent(o,o==r&&t.config.wamSupported?"assertion":"code",i)},n.isBrowserOnline()&&i.currentState==0&&(t.config.wamSupported&&(o==r||t.config.enableSSOV2)?(l=i.authenticationManager.createAuthenticateRequest(),t.config.enableSSOV2?(l.accountType="Cortana",l.resource=a?h:e,a&&(l.scope=c)):(l.accountType="Windows",l.resource=e),t.Promise.safeChain("authenticateAsyncOBO",function(){return i.au